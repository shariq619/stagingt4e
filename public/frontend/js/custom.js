$(document).ready(function($){$(window).on('load',function(){setTimeout(function(){$('.page-loader').fadeOut('slow')},3500)})});$(document).ready(function(){let currentStep=0;const steps=$(".step");const progressItems=$("#progressbar li");function applyCurrentStepClass(){const currentStepNum=$('#progressbar li.active').data('step');const stepEl=$('.questionnaireModalForm .modal-body');if(currentStepNum&&stepEl.length){stepEl.removeClass(function(index,className){return(className.match(/(^|\s)step-\d+/g)||[]).join(' ')});stepEl.addClass(`step-${currentStepNum}`)}}
    function updateQuestionCounter(currentStep){if(currentStep<=6){$('#questionCounter').text(`Question ${currentStep} out of 6`).show()}else{$('#questionCounter').hide()}}
    updateQuestionCounter(1);function showStep(index){steps.removeClass("active").eq(index).addClass("active");progressItems.removeClass("active").removeClass("completed");for(let i=0;i<index;i++){progressItems.eq(i).addClass("completed")}
        progressItems.eq(index).addClass("active");const totalSteps=progressItems.length;const percentage=((index+1)/totalSteps)*100;$("#progressBarFill").css("width",percentage+"%");applyCurrentStepClass()}
    function validateCurrentStep(){let isValidStep=!0;const currentStepEl=steps.eq(currentStep);currentStepEl.find('input[type="radio"]').each(function(){const name=$(this).attr('name');const radios=$(`input[name="${name}"]`);const selected=radios.is(':checked');const errorDiv=radios.closest('.form-group').siblings('.error-message-radio');if(!selected){isValidStep=!1;if(errorDiv.length){errorDiv.show().text('Please select an option')}}else{if(errorDiv.length){errorDiv.hide().text('')}}});currentStepEl.find('input[type="text"], input[type="email"], input[type="tel"]').each(function(){const input=$(this);const value=input.val().trim();const errorDiv=input.siblings('.error-message');if(value===''){isValidStep=!1;if(errorDiv.length){errorDiv.show().text('This field is required')}}else{if(errorDiv.length){errorDiv.hide().text('')}}});return isValidStep}
    $(".next").click(function(){if(validateCurrentStep()){if(currentStep<steps.length-1){currentStep++;showStep(currentStep);applyCurrentStepClass()}}
        updateQuestionCounter(currentStep+1)});$(".prev").click(function(){if(currentStep>0){currentStep--;showStep(currentStep);applyCurrentStepClass()}
        updateQuestionCounter(currentStep-1)});$('input[type="radio"]').on('change',function(){const name=$(this).attr('name');const errorDiv=$(this).closest('.form-group').siblings('.error-message-radio');const selectedFormCheck=$(this).closest('.form-check');const formGroup=selectedFormCheck.closest('.formBorderBottom');formGroup.find('.form-check').removeClass('active');selectedFormCheck.addClass('active');if(errorDiv.length){errorDiv.hide().text('')}});function calculateResultCounts(){let resultCounts={A:0,B:0,C:0};for(let i=1;i<=6;i++){const selected=$(`input[name="question_${i}"]:checked`);const result=selected.data("result");if(result&&resultCounts.hasOwnProperty(result)){resultCounts[result]++}}
        return resultCounts}
    function getHighestResult(resultCounts){let max=0;let maxOption='';for(let option in resultCounts){if(resultCounts[option]>max){max=resultCounts[option];maxOption=option}}
        return maxOption}
    $('#questionnaireSubmit').on('submit',function(e){e.preventDefault();let isValid=!0;for(let i=1;i<=6;i++){const radios=$(`input[name="question_${i}"]`);const selected=radios.is(':checked');const errorDiv=radios.closest('.form-group').siblings('.error-message-radio');if(!selected){isValid=!1;if(errorDiv.length){errorDiv.show().text(`Please select an option for question ${i}`)}}else{if(errorDiv.length){errorDiv.hide().text('')}}}
        const nameInput=$('.questionnaireModalForm input[name="name"]');const emailInput=$('.questionnaireModalForm input[name="email"]');const phoneInput=$('.questionnaireModalForm input[name="phone"]');const recaptchaResponse=grecaptcha.getResponse();$('.error-message').hide().text('');if(nameInput.val().trim()===''){isValid=!1;nameInput.siblings('.error-message').show().text('Please enter your name')}
        if(emailInput.val().trim()===''){isValid=!1;emailInput.siblings('.error-message').show().text('Please enter your email')}
        if(phoneInput.val().trim()===''){isValid=!1;phoneInput.siblings('.error-message').show().text('Please enter your phone number')}
        if(isValid){const url=$(this).attr('action');const token=$('meta[name="csrf-token"]').attr('content');const formData=new FormData(this);const button=$(this).find('button[type="submit"]');const loading=$('#loadingSpinner');loading.show();button.prop('disabled',!0).text('Submitting...');$.ajax({type:'POST',url:url,data:formData,processData:!1,contentType:!1,headers:{'X-CSRF-TOKEN':token}}).done(function(response){document.cookie="questionnaire_form=true; path=/; max-age="+(30*24*60*60);$('#questionnaire').modal('hide');loading.hide();const counts=calculateResultCounts();const highest=getHighestResult(counts);console.log('Counts:',counts);console.log('Highest:',highest);const a=counts.A;const b=counts.B;const c=counts.C;if(a===b&&b===c){$('#modalB').modal('show')}else if(b===c&&b>a){$('#modalA').modal('show')}else if(highest==='A'){$('#modalC').modal('show')}else if(highest==='B'||highest==='C'){$('#modalB').modal('show')}else{$('#modalB').modal('show')}
            grecaptcha.reset()}).fail(function(xhr){loading.hide();const errors=xhr.responseJSON.errors;$('.error-message').text('').hide().removeClass('alert alert-danger');if(errors){if(errors.email){const emailError=errors.email[0];$('input[name="email"]').closest('.form-group').find('.error-message').text(emailError).show().addClass('alert alert-danger')}}else{console.error(xhr.responseText)}
            if(errors['g-recaptcha-response']){const recaptchaError=errors['g-recaptcha-response'][0];$('#recaptchaError').text(recaptchaError).show().addClass('alert alert-danger')}}).always(function(){grecaptcha.reset();loading.hide();button.prop('disabled',!1).text('Reveal My Results')})}})});window.onscroll=function(){scrollFunction()};function scrollFunction(){var scrollBtn=document.getElementById("scrollTopBtn");if(document.body.scrollTop>200||document.documentElement.scrollTop>200){scrollBtn.style.display="block"}else{scrollBtn.style.display="none"}}
function scrollToTop(){window.scrollTo({top:0,behavior:'smooth'})}
$(document).ready(function(){$('.modal').on('hidden.bs.modal',function(){var $iframe=$(this).find('iframe');var src=$iframe.attr('src');$iframe.attr('src','');$iframe.attr('src',src)})});$(document).ready(function(){var toc=$('<ul></ul>');var count=1;var offsetAdjust=560;$('.courseRow').find('h2, h3').each(function(){var id=$(this).attr('id');if(!id){id='heading-'+count++;$(this).attr('id',id)}
    var listItem=$('<li></li>');var link=$('<a></a>').attr('href','#'+id).text($(this).text());listItem.append(link);toc.append(listItem)});$('.tableOfContentTable').append(toc);$('.tableOfContentTable').hide();$('.tableOfContentWrapper').click(function(){$(this).toggleClass('active');$('.tableOfContent').toggleClass('active');$('.tableOfContentTable').slideToggle()});function scrollToHeading(targetId){var target=$(targetId);if(target.length){$('html, body').animate({scrollTop:target.offset().top-offsetAdjust},500)}}
    $('.tableOfContentTable a').on('click',function(event){event.preventDefault();var targetId=$(this).attr('href');scrollToHeading(targetId)});if(window.location.hash){setTimeout(function(){scrollToHeading(window.location.hash)},100)}})
